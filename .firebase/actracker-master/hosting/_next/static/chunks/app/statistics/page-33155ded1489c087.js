(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8894],{331:function(e,a,s){Promise.resolve().then(s.bind(s,99795))},99795:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return G}});var t=s(57437),r=s(48185),n=s(2265),l=s(35231),i=s(85475),d=s(20153),c=s(49354);let o={light:"",dark:".dark"},u=n.createContext(null);function m(){let e=n.useContext(u);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let f=n.forwardRef((e,a)=>{let{id:s,className:r,children:i,config:d,...o}=e,m=n.useId(),f="chart-".concat(s||m.replace(/:/g,""));return(0,t.jsx)(u.Provider,{value:{config:d},children:(0,t.jsxs)("div",{"data-chart":f,ref:a,className:(0,c.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",r),...o,children:[(0,t.jsx)(x,{id:f,config:d}),(0,t.jsx)(l.h,{children:i})]})})});f.displayName="Chart";let x=e=>{let{id:a,config:s}=e,r=Object.entries(s).filter(e=>{let[,a]=e;return a.theme||a.color});return r.length?(0,t.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(o).map(e=>{let[s,t]=e;return"\n".concat(t," [data-chart=").concat(a,"] {\n").concat(r.map(e=>{var a;let[t,r]=e,n=(null===(a=r.theme)||void 0===a?void 0:a[s])||r.color;return n?"  --color-".concat(t,": ").concat(n,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},h=i.u,j=n.forwardRef((e,a)=>{let{active:s,payload:r,className:l,indicator:i="dot",hideLabel:d=!1,hideIndicator:o=!1,label:u,labelFormatter:f,labelClassName:x,formatter:h,color:j,nameKey:p,labelKey:v}=e,{config:b}=m(),y=n.useMemo(()=>{var e;if(d||!(null==r?void 0:r.length))return null;let[a]=r,s="".concat(v||a.dataKey||a.name||"value"),n=g(b,a,s),l=v||"string"!=typeof u?null==n?void 0:n.label:(null===(e=b[u])||void 0===e?void 0:e.label)||u;return f?(0,t.jsx)("div",{className:(0,c.cn)("font-medium",x),children:f(l,r)}):l?(0,t.jsx)("div",{className:(0,c.cn)("font-medium",x),children:l}):null},[u,f,r,d,x,b,v]);if(!s||!(null==r?void 0:r.length))return null;let N=1===r.length&&"dot"!==i;return(0,t.jsxs)("div",{ref:a,className:(0,c.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",l),children:[N?null:y,(0,t.jsx)("div",{className:"grid gap-1.5",children:r.map((e,a)=>{let s="".concat(p||e.name||e.dataKey||"value"),r=g(b,e,s),n=j||e.payload.fill||e.color;return(0,t.jsx)("div",{className:(0,c.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===i&&"items-center"),children:h&&(null==e?void 0:e.value)!==void 0&&e.name?h(e.value,e.name,e,a,e.payload):(0,t.jsxs)(t.Fragment,{children:[(null==r?void 0:r.icon)?(0,t.jsx)(r.icon,{}):!o&&(0,t.jsx)("div",{className:(0,c.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===i,"w-1":"line"===i,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===i,"my-0.5":N&&"dashed"===i}),style:{"--color-bg":n,"--color-border":n}}),(0,t.jsxs)("div",{className:(0,c.cn)("flex flex-1 justify-between leading-none",N?"items-end":"items-center"),children:[(0,t.jsxs)("div",{className:"grid gap-1.5",children:[N?y:null,(0,t.jsx)("span",{className:"text-muted-foreground",children:(null==r?void 0:r.label)||e.name})]}),e.value&&(0,t.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey||e.name)})})]})});j.displayName="ChartTooltip";let p=d.D,v=n.forwardRef((e,a)=>{let{className:s,hideIcon:r=!1,payload:n,verticalAlign:l="bottom",nameKey:i}=e,{config:d}=m();return(null==n?void 0:n.length)?(0,t.jsx)("div",{ref:a,className:(0,c.cn)("flex items-center justify-center gap-4","top"===l?"pb-3":"pt-3",s),children:n.map(e=>{let a="".concat(i||e.dataKey||"value"),s=g(d,e,a);return(0,t.jsxs)("div",{className:(0,c.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==s?void 0:s.icon)&&!r?(0,t.jsx)(s.icon,{}):(0,t.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==s?void 0:s.label]},e.value)})}):null});function g(e,a,s){if("object"!=typeof a||null===a)return;let t="payload"in a&&"object"==typeof a.payload&&null!==a.payload?a.payload:void 0,r=s;return s in a&&"string"==typeof a[s]?r=a[s]:t&&s in t&&"string"==typeof t[s]&&(r=t[s]),r in e?e[r]:e[s]}v.displayName="ChartLegend";var b=s(23909),y=s(85369),N=s(68295),w=s(25974),k=s(54142),R=s(2842),K=s(9542),C=s(45745),_=s(78116),L=s(44711),O=s(85811),S=s(38087),Z=s(87138),A=s(86864),P=s(67568);let M={low:"hsl(var(--chart-2))",medium:"hsl(var(--chart-4))",high:"hsl(var(--destructive))",approved:"hsl(var(--chart-2))",failed:"hsl(var(--destructive))",present:"hsl(var(--chart-2))",absent:"hsl(var(--destructive))"};function G(){let{isLoading:e,groups:a,activeGroup:s,calculateFinalGrade:o,calculateDetailedFinalGrade:u,getStudentRiskLevel:m,partialData:x,activePartialId:g,setActivePartialId:G}=(0,P.e)(),{attendance:D,participations:E}=x,Y=(0,n.useMemo)(()=>s?s.students.map(e=>{let{finalGrade:a}=u(e.id,x,s.criteria||[]),t=0,r=0;Object.keys(D).forEach(a=>{var s;(null===(s=D[a])||void 0===s?void 0:s[e.id])!==void 0&&(r++,D[a][e.id]&&t++)});let n=r>0?t/r*100:100,l=m(a,D,e.id),i=0,d=0;return"high"===l.level&&(i=90,d=80),"medium"===l.level&&(i=50,d=30),{studentName:e.name,currentAttendance:n,projectedGrade:a,riskLevel:l.level,failingRisk:i,dropoutRisk:d}}):[],[s,u,m,x,D]),F=(0,n.useMemo)(()=>{if(!s)return null;let e=0,a=0,t=0,r=0,n=[],l={low:0,medium:0,high:0},i=[{name:"0-20%",students:0},{name:"21-40%",students:0},{name:"41-60%",students:0},{name:"61-80%",students:0},{name:"81-100%",students:0}];for(let t of s.students){let{finalGrade:r}=u(t.id,x,s.criteria||[]);n.push({student:t,grade:r}),r>=60?e++:a++;let d=m(r,D,t.id);l[d.level]++;let c=Object.keys(E).length;if(c>0){let e=Object.values(E).filter(e=>e[t.id]).length/c*100;e<=20?i[0].students++:e<=40?i[1].students++:e<=60?i[2].students++:e<=80?i[3].students++:i[4].students++}else s.students.length>0&&(i[4].students=s.students.length)}for(let e of Object.values(D))for(let a of s.students.map(e=>e.id))Object.prototype.hasOwnProperty.call(e,a)&&(e[a]?t++:r++);return n.sort((e,a)=>a.grade-e.grade),{approvalRate:{approved:e,failed:a},attendanceTotals:{present:t,absent:r},riskDistribution:l,topStudents:n.slice(0,5).map(e=>({name:e.student.name,grade:parseFloat(e.grade.toFixed(1))})),participationDistribution:i}},[s,u,m,D,E,x]),T=(0,n.useMemo)(()=>F?[{name:"Aprobados",value:F.approvalRate.approved,fill:M.approved},{name:"Reprobados",value:F.approvalRate.failed,fill:M.failed}].filter(e=>e.value>0):[],[F]),V=(0,n.useMemo)(()=>F?[{name:"Asistencias",value:F.attendanceTotals.present,fill:M.present},{name:"Inasistencias",value:F.attendanceTotals.absent,fill:M.absent}].filter(e=>e.value>0):[],[F]),B=(0,n.useMemo)(()=>F?[{name:"Riesgo Bajo",value:F.riskDistribution.low,fill:M.low},{name:"Riesgo Medio",value:F.riskDistribution.medium,fill:M.medium},{name:"Riesgo Alto",value:F.riskDistribution.high,fill:M.high}].filter(e=>e.value>0):[],[F]),q=(0,n.useMemo)(()=>Y.map(e=>({name:e.studentName,attendance:parseFloat(e.currentAttendance.toFixed(1)),grade:parseFloat(e.projectedGrade.toFixed(1)),risk:e.riskLevel,fill:"high"===e.riskLevel?"hsl(var(--destructive))":"medium"===e.riskLevel?"hsl(var(--chart-4))":"hsl(var(--chart-2))"})),[Y]),z=(0,n.useMemo)(()=>[{name:"Riesgo Reprobaci\xf3n",count:Y.filter(e=>e.failingRisk>50).length,fill:"hsl(var(--destructive))"},{name:"Riesgo Abandono",count:Y.filter(e=>e.dropoutRisk>50).length,fill:"#f97316"}],[Y]);return e?(0,t.jsxs)("div",{className:"flex justify-center items-center h-full",children:[(0,t.jsx)(S.Z,{className:"h-8 w-8 animate-spin"}),(0,t.jsx)("span",{className:"ml-2",children:"Calculando estad\xedsticas..."})]}):(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Estad\xedsticas"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Analiza el rendimiento de tus grupos y estudiantes."})]})}),(0,t.jsx)(A.mQ,{defaultValue:g,onValueChange:e=>G(e),className:"w-full",children:(0,t.jsxs)(A.dr,{className:"grid w-full grid-cols-3",children:[(0,t.jsx)(A.SP,{value:"p1",children:"Primer Parcial"}),(0,t.jsx)(A.SP,{value:"p2",children:"Segundo Parcial"}),(0,t.jsx)(A.SP,{value:"p3",children:"Tercer Parcial"})]})}),(0,t.jsxs)(A.mQ,{defaultValue:"activeGroup",children:[(0,t.jsx)(A.dr,{className:"grid w-full grid-cols-1",children:(0,t.jsxs)(A.SP,{value:"activeGroup",disabled:!F,children:["Grupo Activo: ",(null==s?void 0:s.subject)||""]})}),(0,t.jsx)(A.nU,{value:"activeGroup",className:"mt-6",children:F?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[(0,t.jsxs)(r.Zb,{children:[(0,t.jsx)(r.Ol,{children:(0,t.jsxs)(r.ll,{children:["Riesgo del Grupo (",(0,c.G)(g),")"]})}),(0,t.jsx)(r.aY,{children:(0,t.jsx)(f,{config:{},className:"min-h-[250px] w-full",children:(0,t.jsxs)(b.u,{children:[(0,t.jsx)(h,{content:(0,t.jsx)(j,{nameKey:"name",hideLabel:!0})}),(0,t.jsx)(y.b,{data:B,dataKey:"value",nameKey:"name",innerRadius:50,outerRadius:70,paddingAngle:5,children:B.map(e=>(0,t.jsx)(N.b,{fill:e.fill},e.name))}),(0,t.jsx)(p,{content:(0,t.jsx)(v,{})})]})})})]}),(0,t.jsxs)(r.Zb,{children:[(0,t.jsx)(r.Ol,{children:(0,t.jsxs)(r.ll,{children:["\xcdndice de Aprobaci\xf3n (",(0,c.G)(g),")"]})}),(0,t.jsx)(r.aY,{children:(0,t.jsx)(f,{config:{},className:"min-h-[250px] w-full",children:(0,t.jsxs)(b.u,{children:[(0,t.jsx)(h,{content:(0,t.jsx)(j,{nameKey:"name",hideLabel:!0})}),(0,t.jsx)(y.b,{data:T,dataKey:"value",nameKey:"name",innerRadius:50,outerRadius:70,paddingAngle:5,children:T.map(e=>(0,t.jsx)(N.b,{fill:e.fill},e.name))}),(0,t.jsx)(p,{content:(0,t.jsx)(v,{})})]})})})]}),(0,t.jsxs)(r.Zb,{children:[(0,t.jsx)(r.Ol,{children:(0,t.jsxs)(r.ll,{children:["\xcdndice de Asistencia (",(0,c.G)(g),")"]})}),(0,t.jsx)(r.aY,{children:(0,t.jsx)(f,{config:{},className:"min-h-[250px] w-full",children:(0,t.jsxs)(b.u,{children:[(0,t.jsx)(h,{content:(0,t.jsx)(j,{nameKey:"name",hideLabel:!0})}),(0,t.jsx)(y.b,{data:V,dataKey:"value",nameKey:"name",innerRadius:50,outerRadius:70,paddingAngle:5,children:V.map(e=>(0,t.jsx)(N.b,{fill:e.fill},e.name))}),(0,t.jsx)(p,{content:(0,t.jsx)(v,{})})]})})})]})]}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)(r.Zb,{children:[(0,t.jsxs)(r.Ol,{children:[(0,t.jsxs)(r.ll,{children:["Mejores Calificaciones (",(0,c.G)(g),")"]}),(0,t.jsx)(r.SZ,{children:"Calificaci\xf3n final de los 5 estudiantes con mejor desempe\xf1o."})]}),(0,t.jsx)(r.aY,{children:(0,t.jsx)(f,{config:{},className:"min-h-[300px] w-full",children:(0,t.jsxs)(w.v,{data:F.topStudents,accessibilityLayer:!0,children:[(0,t.jsx)(k.q,{vertical:!1}),(0,t.jsx)(R.K,{dataKey:"name",tickLine:!1,tickMargin:10,axisLine:!1}),(0,t.jsx)(K.B,{dataKey:"grade",domain:[0,100]}),(0,t.jsx)(h,{content:(0,t.jsx)(j,{})}),(0,t.jsx)(C.$,{dataKey:"grade",name:"Calificaci\xf3n",fill:"hsl(var(--chart-2))",radius:4})]})})})]}),(0,t.jsxs)(r.Zb,{children:[(0,t.jsxs)(r.Ol,{children:[(0,t.jsxs)(r.ll,{children:["Distribuci\xf3n de Participaci\xf3n en Clase (",(0,c.G)(g),")"]}),(0,t.jsx)(r.SZ,{children:"N\xfamero de estudiantes por rango de porcentaje de participaci\xf3n."})]}),(0,t.jsx)(r.aY,{children:(0,t.jsx)(f,{config:{},className:"min-h-[300px] w-full",children:(0,t.jsxs)(w.v,{data:F.participationDistribution,accessibilityLayer:!0,children:[(0,t.jsx)(k.q,{vertical:!1}),(0,t.jsx)(R.K,{dataKey:"name",tickLine:!1,tickMargin:10,axisLine:!1}),(0,t.jsx)(K.B,{dataKey:"students",allowDecimals:!1}),(0,t.jsx)(h,{content:(0,t.jsx)(j,{})}),(0,t.jsx)(C.$,{dataKey:"students",name:"Estudiantes",fill:"hsl(var(--primary))",radius:4})]})})})]})]}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 mt-6",children:[(0,t.jsxs)(r.Zb,{children:[(0,t.jsxs)(r.Ol,{children:[(0,t.jsx)(r.ll,{children:"An\xe1lisis de Riesgo: Asistencia vs Calificaci\xf3n"}),(0,t.jsx)(r.SZ,{children:"Correlaci\xf3n entre asistencia y desempe\xf1o acad\xe9mico proyectado."})]}),(0,t.jsx)(r.aY,{children:(0,t.jsx)("div",{className:"h-[300px] w-full",children:(0,t.jsx)(l.h,{width:"100%",height:"100%",children:(0,t.jsxs)(_.G,{margin:{top:20,right:20,bottom:20,left:20},children:[(0,t.jsx)(k.q,{}),(0,t.jsx)(R.K,{type:"number",dataKey:"attendance",name:"Asistencia",unit:"%",domain:[0,100]}),(0,t.jsx)(K.B,{type:"number",dataKey:"grade",name:"Calificaci\xf3n",unit:"%",domain:[0,100]}),(0,t.jsx)(L.d,{type:"category",dataKey:"name",name:"Estudiante"}),(0,t.jsx)(i.u,{cursor:{strokeDasharray:"3 3"}}),(0,t.jsx)(d.D,{}),(0,t.jsx)(O.b,{name:"Estudiantes",data:q,fill:"#8884d8",children:q.map((e,a)=>(0,t.jsx)(N.b,{fill:e.fill},"cell-".concat(a)))})]})})})})]}),(0,t.jsxs)(r.Zb,{children:[(0,t.jsxs)(r.Ol,{children:[(0,t.jsx)(r.ll,{children:"Predicci\xf3n de Riesgo"}),(0,t.jsx)(r.SZ,{children:"Estudiantes proyectados en riesgo de reprobaci\xf3n vs abandono."})]}),(0,t.jsx)(r.aY,{children:(0,t.jsx)(f,{config:{},className:"min-h-[300px] w-full",children:(0,t.jsxs)(w.v,{data:z,accessibilityLayer:!0,children:[(0,t.jsx)(k.q,{vertical:!1}),(0,t.jsx)(R.K,{dataKey:"name",tickLine:!1,tickMargin:10,axisLine:!1}),(0,t.jsx)(K.B,{dataKey:"count",allowDecimals:!1}),(0,t.jsx)(h,{content:(0,t.jsx)(j,{})}),(0,t.jsx)(C.$,{dataKey:"count",name:"Estudiantes",radius:4,children:z.map((e,a)=>(0,t.jsx)(N.b,{fill:e.fill},"cell-".concat(a)))})]})})})]})]})]}):(0,t.jsx)(r.Zb,{children:(0,t.jsxs)(r.aY,{className:"flex flex-col items-center justify-center text-center p-12 gap-4",children:[(0,t.jsx)(r.ll,{children:"No hay un grupo activo"}),(0,t.jsxs)(r.SZ,{children:["Para ver las estad\xedsticas detalladas, por favor ",(0,t.jsx)(Z.default,{href:"/groups",className:"text-primary underline",children:"selecciona un grupo"})," primero."]})]})})})]})]})}},48185:function(e,a,s){"use strict";s.d(a,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return l},aY:function(){return o},eW:function(){return u},ll:function(){return d}});var t=s(57437),r=s(2265),n=s(49354);let l=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});l.displayName="Card";let i=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})});i.displayName="CardHeader";let d=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});d.displayName="CardTitle";let c=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});c.displayName="CardDescription";let o=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,n.cn)("p-6 pt-0",s),...r})});o.displayName="CardContent";let u=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,n.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"},86864:function(e,a,s){"use strict";s.d(a,{SP:function(){return c},dr:function(){return d},mQ:function(){return i},nU:function(){return o}});var t=s(57437),r=s(2265),n=s(62447),l=s(49354);let i=n.fC,d=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(n.aV,{ref:a,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});d.displayName=n.aV.displayName;let c=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(n.xz,{ref:a,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});c.displayName=n.xz.displayName;let o=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(n.VY,{ref:a,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});o.displayName=n.VY.displayName}},function(e){e.O(0,[4358,139,6900,537,6452,7138,1119,381,7185,3730,2971,7023,1744],function(){return e(e.s=331)}),_N_E=e.O()}]);