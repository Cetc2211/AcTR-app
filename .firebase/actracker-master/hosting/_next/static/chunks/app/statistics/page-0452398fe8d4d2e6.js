(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8894],{77679:function(e,a,s){Promise.resolve().then(s.bind(s,99795))},99795:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return Z}});var t=s(57437),r=s(48185),n=s(2265),l=s(35231),i=s(85475),d=s(20153),c=s(49354);let o={light:"",dark:".dark"},u=n.createContext(null);function f(){let e=n.useContext(u);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let m=n.forwardRef((e,a)=>{let{id:s,className:r,children:i,config:d,...o}=e,f=n.useId(),m="chart-".concat(s||f.replace(/:/g,""));return(0,t.jsx)(u.Provider,{value:{config:d},children:(0,t.jsxs)("div",{"data-chart":m,ref:a,className:(0,c.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",r),...o,children:[(0,t.jsx)(x,{id:m,config:d}),(0,t.jsx)(l.h,{children:i})]})})});m.displayName="Chart";let x=e=>{let{id:a,config:s}=e,r=Object.entries(s).filter(e=>{let[,a]=e;return a.theme||a.color});return r.length?(0,t.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(o).map(e=>{let[s,t]=e;return"\n".concat(t," [data-chart=").concat(a,"] {\n").concat(r.map(e=>{var a;let[t,r]=e,n=(null===(a=r.theme)||void 0===a?void 0:a[s])||r.color;return n?"  --color-".concat(t,": ").concat(n,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},h=i.u,p=n.forwardRef((e,a)=>{let{active:s,payload:r,className:l,indicator:i="dot",hideLabel:d=!1,hideIndicator:o=!1,label:u,labelFormatter:m,labelClassName:x,formatter:h,color:p,nameKey:j,labelKey:v}=e,{config:b}=f(),y=n.useMemo(()=>{var e;if(d||!(null==r?void 0:r.length))return null;let[a]=r,s="".concat(v||a.dataKey||a.name||"value"),n=g(b,a,s),l=v||"string"!=typeof u?null==n?void 0:n.label:(null===(e=b[u])||void 0===e?void 0:e.label)||u;return m?(0,t.jsx)("div",{className:(0,c.cn)("font-medium",x),children:m(l,r)}):l?(0,t.jsx)("div",{className:(0,c.cn)("font-medium",x),children:l}):null},[u,m,r,d,x,b,v]);if(!s||!(null==r?void 0:r.length))return null;let N=1===r.length&&"dot"!==i;return(0,t.jsxs)("div",{ref:a,className:(0,c.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",l),children:[N?null:y,(0,t.jsx)("div",{className:"grid gap-1.5",children:r.map((e,a)=>{let s="".concat(j||e.name||e.dataKey||"value"),r=g(b,e,s),n=p||e.payload.fill||e.color;return(0,t.jsx)("div",{className:(0,c.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===i&&"items-center"),children:h&&(null==e?void 0:e.value)!==void 0&&e.name?h(e.value,e.name,e,a,e.payload):(0,t.jsxs)(t.Fragment,{children:[(null==r?void 0:r.icon)?(0,t.jsx)(r.icon,{}):!o&&(0,t.jsx)("div",{className:(0,c.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===i,"w-1":"line"===i,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===i,"my-0.5":N&&"dashed"===i}),style:{"--color-bg":n,"--color-border":n}}),(0,t.jsxs)("div",{className:(0,c.cn)("flex flex-1 justify-between leading-none",N?"items-end":"items-center"),children:[(0,t.jsxs)("div",{className:"grid gap-1.5",children:[N?y:null,(0,t.jsx)("span",{className:"text-muted-foreground",children:(null==r?void 0:r.label)||e.name})]}),e.value&&(0,t.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey||e.name)})})]})});p.displayName="ChartTooltip";let j=d.D,v=n.forwardRef((e,a)=>{let{className:s,hideIcon:r=!1,payload:n,verticalAlign:l="bottom",nameKey:i}=e,{config:d}=f();return(null==n?void 0:n.length)?(0,t.jsx)("div",{ref:a,className:(0,c.cn)("flex items-center justify-center gap-4","top"===l?"pb-3":"pt-3",s),children:n.map(e=>{let a="".concat(i||e.dataKey||"value"),s=g(d,e,a);return(0,t.jsxs)("div",{className:(0,c.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==s?void 0:s.icon)&&!r?(0,t.jsx)(s.icon,{}):(0,t.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==s?void 0:s.label]},e.value)})}):null});function g(e,a,s){if("object"!=typeof a||null===a)return;let t="payload"in a&&"object"==typeof a.payload&&null!==a.payload?a.payload:void 0,r=s;return s in a&&"string"==typeof a[s]?r=a[s]:t&&s in t&&"string"==typeof t[s]&&(r=t[s]),r in e?e[r]:e[s]}v.displayName="ChartLegend";var b=s(23909),y=s(85369),N=s(68295),w=s(25974),k=s(54142),R=s(2842),C=s(9542),_=s(45745),K=s(38087),O=s(87138),P=s(86864),S=s(67568);let L={low:"hsl(var(--chart-2))",medium:"hsl(var(--chart-4))",high:"hsl(var(--destructive))",approved:"hsl(var(--chart-2))",failed:"hsl(var(--destructive))",present:"hsl(var(--chart-2))",absent:"hsl(var(--destructive))"};function Z(){let{isLoading:e,groups:a,activeGroup:s,calculateFinalGrade:l,getStudentRiskLevel:i,partialData:d,activePartialId:o,setActivePartialId:u}=(0,S.e)(),{attendance:f,participations:x}=d,g=(0,n.useMemo)(()=>{if(!s)return null;let e=0,a=0,t=0,r=0,n=[],d={low:0,medium:0,high:0},c=[{name:"0-20%",students:0},{name:"21-40%",students:0},{name:"41-60%",students:0},{name:"61-80%",students:0},{name:"81-100%",students:0}];for(let t of s.students){let r=l(t.id);n.push({student:t,grade:r}),r>=60?e++:a++;let o=i(r,f,t.id);d[o.level]++;let u=Object.keys(x).length;if(u>0){let e=Object.values(x).filter(e=>e[t.id]).length/u*100;e<=20?c[0].students++:e<=40?c[1].students++:e<=60?c[2].students++:e<=80?c[3].students++:c[4].students++}else s.students.length>0&&(c[4].students=s.students.length)}for(let e of Object.values(f))for(let a of s.students.map(e=>e.id))Object.prototype.hasOwnProperty.call(e,a)&&(e[a]?t++:r++);return n.sort((e,a)=>a.grade-e.grade),{approvalRate:{approved:e,failed:a},attendanceTotals:{present:t,absent:r},riskDistribution:d,topStudents:n.slice(0,5).map(e=>({name:e.student.name,grade:parseFloat(e.grade.toFixed(1))})),participationDistribution:c}},[s,l,i,f,x]),Z=(0,n.useMemo)(()=>g?[{name:"Aprobados",value:g.approvalRate.approved,fill:L.approved},{name:"Reprobados",value:g.approvalRate.failed,fill:L.failed}].filter(e=>e.value>0):[],[g]),A=(0,n.useMemo)(()=>g?[{name:"Asistencias",value:g.attendanceTotals.present,fill:L.present},{name:"Inasistencias",value:g.attendanceTotals.absent,fill:L.absent}].filter(e=>e.value>0):[],[g]),G=(0,n.useMemo)(()=>g?[{name:"Riesgo Bajo",value:g.riskDistribution.low,fill:L.low},{name:"Riesgo Medio",value:g.riskDistribution.medium,fill:L.medium},{name:"Riesgo Alto",value:g.riskDistribution.high,fill:L.high}].filter(e=>e.value>0):[],[g]);return e?(0,t.jsxs)("div",{className:"flex justify-center items-center h-full",children:[(0,t.jsx)(K.Z,{className:"h-8 w-8 animate-spin"}),(0,t.jsx)("span",{className:"ml-2",children:"Calculando estad\xedsticas..."})]}):(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Estad\xedsticas"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Analiza el rendimiento de tus grupos y estudiantes."})]})}),(0,t.jsx)(P.mQ,{defaultValue:o,onValueChange:e=>u(e),className:"w-full",children:(0,t.jsxs)(P.dr,{className:"grid w-full grid-cols-3",children:[(0,t.jsx)(P.SP,{value:"p1",children:"Primer Parcial"}),(0,t.jsx)(P.SP,{value:"p2",children:"Segundo Parcial"}),(0,t.jsx)(P.SP,{value:"p3",children:"Tercer Parcial"})]})}),(0,t.jsxs)(P.mQ,{defaultValue:"activeGroup",children:[(0,t.jsx)(P.dr,{className:"grid w-full grid-cols-1",children:(0,t.jsxs)(P.SP,{value:"activeGroup",disabled:!g,children:["Grupo Activo: ",(null==s?void 0:s.subject)||""]})}),(0,t.jsx)(P.nU,{value:"activeGroup",className:"mt-6",children:g?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[(0,t.jsxs)(r.Zb,{children:[(0,t.jsx)(r.Ol,{children:(0,t.jsxs)(r.ll,{children:["Riesgo del Grupo (",(0,c.G)(o),")"]})}),(0,t.jsx)(r.aY,{children:(0,t.jsx)(m,{config:{},className:"min-h-[250px] w-full",children:(0,t.jsxs)(b.u,{children:[(0,t.jsx)(h,{content:(0,t.jsx)(p,{nameKey:"name",hideLabel:!0})}),(0,t.jsx)(y.b,{data:G,dataKey:"value",nameKey:"name",innerRadius:50,outerRadius:70,paddingAngle:5,children:G.map(e=>(0,t.jsx)(N.b,{fill:e.fill},e.name))}),(0,t.jsx)(j,{content:(0,t.jsx)(v,{})})]})})})]}),(0,t.jsxs)(r.Zb,{children:[(0,t.jsx)(r.Ol,{children:(0,t.jsxs)(r.ll,{children:["\xcdndice de Aprobaci\xf3n (",(0,c.G)(o),")"]})}),(0,t.jsx)(r.aY,{children:(0,t.jsx)(m,{config:{},className:"min-h-[250px] w-full",children:(0,t.jsxs)(b.u,{children:[(0,t.jsx)(h,{content:(0,t.jsx)(p,{nameKey:"name",hideLabel:!0})}),(0,t.jsx)(y.b,{data:Z,dataKey:"value",nameKey:"name",innerRadius:50,outerRadius:70,paddingAngle:5,children:Z.map(e=>(0,t.jsx)(N.b,{fill:e.fill},e.name))}),(0,t.jsx)(j,{content:(0,t.jsx)(v,{})})]})})})]}),(0,t.jsxs)(r.Zb,{children:[(0,t.jsx)(r.Ol,{children:(0,t.jsxs)(r.ll,{children:["\xcdndice de Asistencia (",(0,c.G)(o),")"]})}),(0,t.jsx)(r.aY,{children:(0,t.jsx)(m,{config:{},className:"min-h-[250px] w-full",children:(0,t.jsxs)(b.u,{children:[(0,t.jsx)(h,{content:(0,t.jsx)(p,{nameKey:"name",hideLabel:!0})}),(0,t.jsx)(y.b,{data:A,dataKey:"value",nameKey:"name",innerRadius:50,outerRadius:70,paddingAngle:5,children:A.map(e=>(0,t.jsx)(N.b,{fill:e.fill},e.name))}),(0,t.jsx)(j,{content:(0,t.jsx)(v,{})})]})})})]})]}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)(r.Zb,{children:[(0,t.jsxs)(r.Ol,{children:[(0,t.jsxs)(r.ll,{children:["Mejores Calificaciones (",(0,c.G)(o),")"]}),(0,t.jsx)(r.SZ,{children:"Calificaci\xf3n final de los 5 estudiantes con mejor desempe\xf1o."})]}),(0,t.jsx)(r.aY,{children:(0,t.jsx)(m,{config:{},className:"min-h-[300px] w-full",children:(0,t.jsxs)(w.v,{data:g.topStudents,accessibilityLayer:!0,children:[(0,t.jsx)(k.q,{vertical:!1}),(0,t.jsx)(R.K,{dataKey:"name",tickLine:!1,tickMargin:10,axisLine:!1}),(0,t.jsx)(C.B,{dataKey:"grade",domain:[0,100]}),(0,t.jsx)(h,{content:(0,t.jsx)(p,{})}),(0,t.jsx)(_.$,{dataKey:"grade",name:"Calificaci\xf3n",fill:"hsl(var(--chart-2))",radius:4})]})})})]}),(0,t.jsxs)(r.Zb,{children:[(0,t.jsxs)(r.Ol,{children:[(0,t.jsxs)(r.ll,{children:["Distribuci\xf3n de Participaci\xf3n en Clase (",(0,c.G)(o),")"]}),(0,t.jsx)(r.SZ,{children:"N\xfamero de estudiantes por rango de porcentaje de participaci\xf3n."})]}),(0,t.jsx)(r.aY,{children:(0,t.jsx)(m,{config:{},className:"min-h-[300px] w-full",children:(0,t.jsxs)(w.v,{data:g.participationDistribution,accessibilityLayer:!0,children:[(0,t.jsx)(k.q,{vertical:!1}),(0,t.jsx)(R.K,{dataKey:"name",tickLine:!1,tickMargin:10,axisLine:!1}),(0,t.jsx)(C.B,{dataKey:"students",allowDecimals:!1}),(0,t.jsx)(h,{content:(0,t.jsx)(p,{})}),(0,t.jsx)(_.$,{dataKey:"students",name:"Estudiantes",fill:"hsl(var(--primary))",radius:4})]})})})]})]})]}):(0,t.jsx)(r.Zb,{children:(0,t.jsxs)(r.aY,{className:"flex flex-col items-center justify-center text-center p-12 gap-4",children:[(0,t.jsx)(r.ll,{children:"No hay un grupo activo"}),(0,t.jsxs)(r.SZ,{children:["Para ver las estad\xedsticas detalladas, por favor ",(0,t.jsx)(O.default,{href:"/groups",className:"text-primary underline",children:"selecciona un grupo"})," primero."]})]})})})]})]})}},48185:function(e,a,s){"use strict";s.d(a,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return l},aY:function(){return o},eW:function(){return u},ll:function(){return d}});var t=s(57437),r=s(2265),n=s(49354);let l=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});l.displayName="Card";let i=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})});i.displayName="CardHeader";let d=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});d.displayName="CardTitle";let c=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});c.displayName="CardDescription";let o=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,n.cn)("p-6 pt-0",s),...r})});o.displayName="CardContent";let u=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,n.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"},86864:function(e,a,s){"use strict";s.d(a,{SP:function(){return c},dr:function(){return d},mQ:function(){return i},nU:function(){return o}});var t=s(57437),r=s(2265),n=s(62447),l=s(49354);let i=n.fC,d=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(n.aV,{ref:a,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});d.displayName=n.aV.displayName;let c=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(n.xz,{ref:a,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});c.displayName=n.xz.displayName;let o=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(n.VY,{ref:a,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});o.displayName=n.VY.displayName}},function(e){e.O(0,[4358,139,6900,6902,7138,1119,381,6985,3730,2971,7023,1744],function(){return e(e.s=77679)}),_N_E=e.O()}]);