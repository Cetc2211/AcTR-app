(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5060],{62735:function(e,t,s){Promise.resolve().then(s.bind(s,65778))},65778:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return V}});var a=s(57437),r=s(48185),n=s(47304),i=s(79055),l=s(89733),d=s(16463),o=s(66648),c=s(87138),u=s(38087),m=s(68078),f=s(29320),h=s(23218),x=s(86644),p=s(14468),g=s(83625),j=s(19847),v=s(74732),N=s(80032),b=s(41352),y=s(77565),w=s(21096),C=s(60258),k=s(98604),R=s(31590),S=s(29943),E=s(54662),z=s(70402),T=s(2265),A=s(86763),_=s(4919),F=s(44541),O=s(67568),I=s(77209),P=s(49354),Z=s(86864),D=s(15026);function V(){let e=(0,d.useParams)().groupId,{isLoading:t,groups:s,allStudents:V,allObservations:G,setActiveGroupId:M,setAllStudents:U,activeGroup:L,partialData:Y,allPartialsDataForActiveGroup:$,deleteGroup:q,activePartialId:X,setActivePartialId:B,calculateFinalGrade:W,calculateDetailedFinalGrade:H,getStudentRiskLevel:J,addStudentsToGroup:K,removeStudentFromGroup:Q,updateGroup:ee,updateStudent:et}=(0,O.e)(),{attendance:es}=Y,{criteria:ea=[]}=L||{},er=(0,d.useRouter)(),{toast:en}=(0,A.pm)(),[ei,el]=(0,T.useState)(!1),[ed,eo]=(0,T.useState)(!1),[ec,eu]=(0,T.useState)(null),[em,ef]=(0,T.useState)(!1),[eh,ex]=(0,T.useState)(null),[ep,eg]=(0,T.useState)(""),[ej,ev]=(0,T.useState)(""),[eN,eb]=(0,T.useState)(""),[ey,ew]=(0,T.useState)(""),[eC,ek]=(0,T.useState)(""),[eR,eS]=(0,T.useState)(!1),[eE,ez]=(0,T.useState)([]),[eT,eA]=(0,T.useState)(!1),[e_,eF]=(0,T.useState)(!1),[eO,eI]=(0,T.useState)(null),[eP,eZ]=(0,T.useState)(!1),[eD,eV]=(0,T.useState)(null),eG=(0,T.useRef)(null),eM=(0,T.useRef)(null),[eU,eL]=(0,T.useState)([]),[eY,e$]=(0,T.useState)(void 0);(0,T.useEffect)(()=>{e&&M(e)},[e,M]),(0,T.useEffect)(()=>{let e=null;return(async()=>{if(e_&&eP)try{let t=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"videoinput"===e.kind);eL(t),e=await navigator.mediaDevices.getUserMedia({video:{deviceId:eY?{exact:eY}:void 0}}),eV(!0),eG.current&&(eG.current.srcObject=e),!eY&&t.length>0&&e$(t[0].deviceId)}catch(e){console.error("Error accessing camera:",e),eV(!1),en({variant:"destructive",title:"Acceso a la c\xe1mara denegado",description:"Por favor, habilita los permisos de la c\xe1mara en tu navegador."}),eZ(!1)}})(),()=>{e&&e.getTracks().forEach(e=>e.stop());let t=eG.current;t&&(t.srcObject=null)}},[e_,eP,en,eY]);let eq=(0,T.useMemo)(()=>{if(!L)return{};let e={};return L.students.forEach(t=>{var s;let a=Object.keys(Y.attendance||{}).length,r=(0,D.l)(t,Y,L.criteria||[],a,(null===(s=G[t.id])||void 0===s?void 0:s.map(e=>e.details))||[]);e[t.id]={level:r.riskLevel,reason:r.riskFactors.join(", ")}}),e},[L,Y,G]),eX=(0,T.useMemo)(()=>{if(!L)return[];let e=Object.keys(Y.attendance||{}).length;return L.students.map(t=>{var s;let a;let r=["p1","p2","p3"].map(e=>{let s=$[e];if(!s)return null;let a=Object.keys(s.attendance||{}).length,r=!1;if(s.grades&&Object.keys(s.grades[t.id]||{}).length>0&&(r=!0),s.recoveryGrades&&s.recoveryGrades[t.id]&&(r=!0),s.attendance&&Object.values(s.attendance).some(e=>void 0!==e[t.id])&&(r=!0),!r&&0===a)return null;let n=(0,D.l)(t,s,L.criteria||[],a,[]);return r||100!==n.currentGrade?{id:e,label:"p1"===e?"P1":"p2"===e?"P2":"P3",grade:n.currentGrade,attendance:n.currentAttendance,isCurrent:e===X,isRecovery:n.isRecovery}:null}).filter(e=>null!==e);L.isSemesterIntegrated&&r.length>0&&(a=r.reduce((e,t)=>e+t.grade,0)/r.length);let n=(0,D.l)(t,Y,L.criteria||[],e,(null===(s=G[t.id])||void 0===s?void 0:s.map(e=>e.details))||[],a);return{studentId:t.id,studentName:t.name,riskLevel:n.riskLevel,failingRisk:n.failingRisk,dropoutRisk:n.dropoutRisk,riskFactors:n.riskFactors,predictionMessage:n.predictionMessage,history:r,isRecovery:n.isRecovery}})},[L,Y,V,$,X,G]),eB=e=>{L&&(e.forEach(e=>{Q(L.id,e)}),en({title:"Estudiante(s) eliminado(s)",description:"El/los estudiante(s) ha(n) sido quitado(s) del grupo."}),eT&&eK())},eW=async()=>{if(!L||eR)return;let e=ep.trim().split("\n").filter(e=>e),t=ej.trim().split("\n"),s=eN.trim().split("\n"),a=ey.trim().split("\n"),r=eC.trim().split("\n");if(0===e.length){en({variant:"destructive",title:"Error",description:"Por favor, ingresa al menos un nombre de estudiante."});return}eS(!0);try{let n=e.map((e,n)=>{var i,l,d,o;return{id:"S".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,5),"-").concat(n),name:e.trim(),email:(null===(i=t[n])||void 0===i?void 0:i.trim())||"",phone:(null===(l=s[n])||void 0===l?void 0:l.trim())||"",tutorName:(null===(d=a[n])||void 0===d?void 0:d.trim())||"",tutorPhone:(null===(o=r[n])||void 0===o?void 0:o.trim())||"",photo:"https://placehold.co/100x100.png"}});await K(L.id,n),eg(""),ev(""),eb(""),ew(""),ek(""),en({title:"Estudiantes agregados",description:"".concat(n.length," estudiante(s) han sido a\xf1adidos al grupo.")}),el(!1)}catch(e){console.error("Failed to add students:",e),en({variant:"destructive",title:"Error al agregar",description:"No se pudieron agregar los estudiantes. Int\xe9ntalo de nuevo."})}finally{eS(!1)}},eH=e=>{ez(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},eJ=e=>{e&&L?ez(L.students.map(e=>e.id)):ez([])},eK=()=>{eA(!1),ez([])},eQ=e=>{ex(e),eI(e.photo),eZ(!1),e$(void 0),eL([]),eF(!0)},e0=async()=>{eh&&eO&&(await et(eh.id,{photo:eO}),en({title:"Foto actualizada",description:"Se ha cambiado la foto de ".concat(eh.name,".")}),eF(!1),ex(null),eI(null))},e2=async()=>{ec&&(await ee(ec.id,{subject:ec.subject,semester:ec.semester,groupName:ec.groupName,facilitator:ec.facilitator}),en({title:"Grupo Actualizado",description:"La informaci\xf3n del grupo ha sido guardada."}),eo(!1))},e5=e=>{ex({...e}),ef(!0)},e4=async()=>{eh&&(await et(eh.id,{name:eh.name,email:eh.email,phone:eh.phone,tutorName:eh.tutorName,tutorPhone:eh.tutorPhone}),en({title:"Estudiante Actualizado",description:"La informaci\xf3n de ".concat(eh.name," ha sido guardada.")}),ef(!1))},e1=(0,T.useMemo)(()=>ea.reduce((e,t)=>e+t.weight,0),[ea]),e3=eE.length;return t?(0,a.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,a.jsx)(u.Z,{className:"h-8 w-8 animate-spin"})}):L?(0,a.jsxs)(a.Fragment,{children:[eh&&(0,a.jsx)(E.Vq,{open:e_,onOpenChange:eF,children:(0,a.jsxs)(E.cZ,{children:[(0,a.jsxs)(E.fK,{children:[(0,a.jsxs)(E.$N,{children:["Cambiar Foto de ",eh.name]}),(0,a.jsx)(E.Be,{children:"Usa tu c\xe1mara para tomar una foto o sube un archivo."})]}),(0,a.jsxs)("div",{className:"py-4 flex flex-col items-center gap-4",children:[(0,a.jsx)("div",{className:"relative w-32 h-32",children:eP?(0,a.jsx)("video",{ref:eG,className:"rounded-full aspect-square object-cover w-32 h-32",autoPlay:!0,playsInline:!0,muted:!0}):(0,a.jsx)(o.default,{alt:"Vista previa",className:"rounded-full aspect-square object-cover w-32 h-32",height:128,src:eO||eh.photo,width:128})}),(0,a.jsx)("canvas",{ref:eM,className:"hidden"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[eP?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.z,{onClick:()=>{if(eG.current&&eM.current){let e=eG.current,t=eM.current;t.width=e.videoWidth,t.height=e.videoHeight;let s=t.getContext("2d");s&&(s.drawImage(e,0,0,t.width,t.height),eI(t.toDataURL("image/png")),eZ(!1))}},children:[(0,a.jsx)(m.Z,{className:"mr-2"})," Capturar Foto"]}),eU.length>1&&(0,a.jsxs)(l.z,{variant:"outline",onClick:()=>{if(eU.length>1){let e=(eU.findIndex(e=>e.deviceId===eY)+1)%eU.length;e$(eU[e].deviceId)}},children:[(0,a.jsx)(f.Z,{className:"mr-2"})," Girar C\xe1mara"]})]}):(0,a.jsxs)(l.z,{variant:"outline",onClick:()=>eZ(!0),children:[(0,a.jsx)(m.Z,{className:"mr-2"})," Usar C\xe1mara"]}),!eP&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(l.z,{asChild:!0,variant:"outline",children:(0,a.jsxs)(z._,{htmlFor:"photo-upload",children:[(0,a.jsx)(h.Z,{className:"mr-2"})," Subir Archivo"]})}),(0,a.jsx)(I.I,{id:"photo-upload",type:"file",accept:"image/*",className:"absolute inset-0 opacity-0 w-full h-full cursor-pointer",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){let e=new FileReader;e.onloadend=()=>{eI(e.result)},e.readAsDataURL(s)}}})]})]})]}),(0,a.jsxs)(E.cN,{children:[(0,a.jsx)(l.z,{variant:"outline",onClick:()=>eF(!1),children:"Cancelar"}),(0,a.jsx)(l.z,{onClick:e0,disabled:eO===eh.photo,children:"Guardar Foto"})]})]})}),ec&&(0,a.jsx)(E.Vq,{open:ed,onOpenChange:eo,children:(0,a.jsxs)(E.cZ,{className:"sm:max-w-lg",children:[(0,a.jsxs)(E.fK,{children:[(0,a.jsx)(E.$N,{children:"Editar Grupo"}),(0,a.jsx)(E.Be,{children:"Actualiza la informaci\xf3n de tu grupo."})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z._,{htmlFor:"edit-subject",children:"Nombre de la Asignatura"}),(0,a.jsx)(I.I,{id:"edit-subject",value:ec.subject,onChange:e=>eu({...ec,subject:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z._,{htmlFor:"edit-semester",children:"Semestre"}),(0,a.jsx)(I.I,{id:"edit-semester",value:ec.semester||"",onChange:e=>eu({...ec,semester:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z._,{htmlFor:"edit-groupName",children:"Grupo"}),(0,a.jsx)(I.I,{id:"edit-groupName",value:ec.groupName||"",onChange:e=>eu({...ec,groupName:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z._,{htmlFor:"edit-facilitator",children:"Facilitador"}),(0,a.jsx)(I.I,{id:"edit-facilitator",value:ec.facilitator||"",onChange:e=>eu({...ec,facilitator:e.target.value})})]})]}),(0,a.jsxs)(E.cN,{children:[(0,a.jsx)(l.z,{variant:"outline",onClick:()=>eo(!1),children:"Cancelar"}),(0,a.jsx)(l.z,{onClick:e2,children:"Guardar Cambios"})]})]})}),eh&&(0,a.jsx)(E.Vq,{open:em,onOpenChange:ef,children:(0,a.jsxs)(E.cZ,{className:"sm:max-w-lg",children:[(0,a.jsxs)(E.fK,{children:[(0,a.jsx)(E.$N,{children:"Editar Estudiante"}),(0,a.jsxs)(E.Be,{children:["Actualiza la informaci\xf3n de ",eh.name,"."]})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z._,{htmlFor:"edit-student-name",children:"Nombre"}),(0,a.jsx)(I.I,{id:"edit-student-name",value:eh.name,onChange:e=>ex({...eh,name:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z._,{htmlFor:"edit-student-email",children:"Email"}),(0,a.jsx)(I.I,{id:"edit-student-email",type:"email",value:eh.email||"",onChange:e=>ex({...eh,email:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z._,{htmlFor:"edit-student-phone",children:"Tel\xe9fono"}),(0,a.jsx)(I.I,{id:"edit-student-phone",type:"tel",value:eh.phone||"",onChange:e=>ex({...eh,phone:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z._,{htmlFor:"edit-student-tutorName",children:"Nombre del Tutor"}),(0,a.jsx)(I.I,{id:"edit-student-tutorName",value:eh.tutorName||"",onChange:e=>ex({...eh,tutorName:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z._,{htmlFor:"edit-student-tutorPhone",children:"Tel\xe9fono del Tutor"}),(0,a.jsx)(I.I,{id:"edit-student-tutorPhone",type:"tel",value:eh.tutorPhone||"",onChange:e=>ex({...eh,tutorPhone:e.target.value})})]})]}),(0,a.jsxs)(E.cN,{children:[(0,a.jsx)(l.z,{variant:"outline",onClick:()=>ef(!1),children:"Cancelar"}),(0,a.jsx)(l.z,{onClick:e4,children:"Guardar Cambios"})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(l.z,{asChild:!0,variant:"outline",size:"icon",children:(0,a.jsxs)(c.default,{href:"/groups",children:[(0,a.jsx)(x.Z,{}),(0,a.jsx)("span",{className:"sr-only",children:"Volver a grupos"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:L.subject}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:[L.semester&&"Semestre: ".concat(L.semester," | "),L.groupName&&"Grupo: ".concat(L.groupName," | "),L.facilitator&&"Facilitador: ".concat(L.facilitator)]})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)(S.aR,{children:[(0,a.jsxs)(R.h_,{children:[(0,a.jsx)(R.$F,{asChild:!0,children:(0,a.jsx)(l.z,{variant:"outline",size:"icon",children:(0,a.jsx)(p.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(R.AW,{align:"end",children:[(0,a.jsx)(R.Ju,{children:"Opciones del Grupo"}),(0,a.jsx)(R.VD,{}),(0,a.jsxs)(R.Xi,{onSelect:()=>{L&&(eu({...L}),eo(!0))},children:[(0,a.jsx)(g.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Editar Grupo"})]}),(0,a.jsx)(S.vW,{asChild:!0,children:(0,a.jsxs)(R.Xi,{onSelect:e=>e.preventDefault(),className:"text-destructive flex items-center gap-2",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Eliminar Grupo"})]})})]})]}),(0,a.jsxs)(S._T,{children:[(0,a.jsxs)(S.fY,{children:[(0,a.jsx)(S.f$,{children:"\xbfEst\xe1s absolutamente seguro?"}),(0,a.jsx)(S.yT,{children:"Esta acci\xf3n no se puede deshacer. Esto eliminar\xe1 permanentemente el grupo y todos sus datos asociados (criterios, calificaciones, etc.)."})]}),(0,a.jsxs)(S.xo,{children:[(0,a.jsx)(S.le,{children:"Cancelar"}),(0,a.jsx)(S.OL,{onClick:()=>{L&&(q(L.id),en({title:"Grupo Eliminado",description:'El grupo "'.concat(L.subject,'" ha sido eliminado.')}),er.push("/groups"))},children:"S\xed, eliminar"})]})]})]})})]}),(0,a.jsxs)(Z.mQ,{defaultValue:X,onValueChange:e=>B(e),className:"w-full",children:[(0,a.jsxs)(Z.dr,{className:"grid w-full grid-cols-3",children:[(0,a.jsx)(Z.SP,{value:"p1",children:"Primer Parcial"}),(0,a.jsx)(Z.SP,{value:"p2",children:"Segundo Parcial"}),(0,a.jsx)(Z.SP,{value:"p3",children:"Tercer Parcial"})]}),(0,a.jsx)(Z.nU,{value:X,className:"mt-4",children:(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[(0,a.jsxs)(r.Zb,{className:"lg:col-span-2",children:[(0,a.jsx)(r.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(r.ll,{children:"Estudiantes en el Grupo"}),(0,a.jsxs)(r.SZ,{children:["Actualmente hay ",L.students.length," estudiantes en este grupo."]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[eT?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.z,{variant:"outline",size:"sm",onClick:eK,className:"gap-1",children:[(0,a.jsx)(v.Z,{className:"h-3.5 w-3.5"}),"Cancelar"]}),e3>0&&(0,a.jsxs)(S.aR,{children:[(0,a.jsx)(S.vW,{asChild:!0,children:(0,a.jsxs)(l.z,{variant:"destructive",size:"sm",className:"gap-1",children:[(0,a.jsx)(j.Z,{className:"h-3.5 w-3.5"}),(0,a.jsxs)("span",{children:["Eliminar (",e3,")"]})]})}),(0,a.jsxs)(S._T,{children:[(0,a.jsxs)(S.fY,{children:[(0,a.jsxs)(S.f$,{children:["\xbfEliminar ",e3," estudiante(s)?"]}),(0,a.jsx)(S.yT,{children:"Esta acci\xf3n no se puede deshacer. Se quitar\xe1n los estudiantes seleccionados de este grupo, pero no se eliminar\xe1n de la lista general de estudiantes."})]}),(0,a.jsxs)(S.xo,{children:[(0,a.jsx)(S.le,{children:"Cancelar"}),(0,a.jsx)(S.OL,{onClick:()=>{eB(eE)},children:"S\xed, eliminar del grupo"})]})]})]})]}):(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>eA(!0),children:"Seleccionar Estudiantes"}),(0,a.jsxs)(E.Vq,{open:ei,onOpenChange:el,children:[(0,a.jsx)(E.hg,{asChild:!0,children:(0,a.jsxs)(l.z,{size:"sm",className:"gap-1",children:[(0,a.jsx)(N.Z,{className:"h-3.5 w-3.5"}),(0,a.jsx)("span",{className:"sr-only sm:not-sr-only sm:whitespace-nowrap",children:"Agregar Estudiantes"})]})}),(0,a.jsxs)(E.cZ,{className:"sm:max-w-xl",children:[(0,a.jsxs)(E.fK,{children:[(0,a.jsx)(E.$N,{children:"Agregar Nuevos Estudiantes al Grupo"}),(0,a.jsxs)(E.Be,{children:['A\xf1ade nuevos estudiantes a "',L.subject,'". Pega columnas de datos para agregarlos en masa.']})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4 max-h-[400px] overflow-y-auto",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Pega una columna de datos en cada campo. Aseg\xfarate de que cada l\xednea corresponda al mismo estudiante."}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z._,{htmlFor:"bulkNames",children:"Nombres*"}),(0,a.jsx)(_.g,{id:"bulkNames",placeholder:"Laura Jimenez\\nCarlos Sanchez",rows:5,value:ep,onChange:e=>eg(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z._,{htmlFor:"bulkEmails",children:"Emails"}),(0,a.jsx)(_.g,{id:"bulkEmails",placeholder:"laura.j@example.com\\ncarlos.s@example.com",rows:5,value:ej,onChange:e=>ev(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z._,{htmlFor:"bulkPhones",children:"Tel\xe9fonos"}),(0,a.jsx)(_.g,{id:"bulkPhones",placeholder:"555-3344\\n555-6677",rows:5,value:eN,onChange:e=>eb(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z._,{htmlFor:"bulkTutorNames",children:"Nombres de Tutores"}),(0,a.jsx)(_.g,{id:"bulkTutorNames",placeholder:"Ricardo Jimenez\\nMaria Sanchez",rows:5,value:ey,onChange:e=>ew(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2 col-span-2",children:[(0,a.jsx)(z._,{htmlFor:"bulkTutorPhones",children:"Tel\xe9fonos de Tutores"}),(0,a.jsx)(_.g,{id:"bulkTutorPhones",placeholder:"555-3355\\n555-6688",rows:5,value:eC,onChange:e=>ek(e.target.value)})]})]})]}),(0,a.jsxs)(E.cN,{children:[(0,a.jsx)(l.z,{variant:"outline",onClick:()=>el(!1),disabled:eR,children:"Cancelar"}),(0,a.jsxs)(l.z,{onClick:eW,disabled:eR||!ep.trim(),children:[eR&&(0,a.jsx)(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Agregar Estudiantes"]})]})]})]})]})]})}),(0,a.jsx)(r.aY,{className:"p-0",children:(0,a.jsxs)(n.iA,{children:[(0,a.jsx)(n.xD,{children:(0,a.jsxs)(n.SC,{children:[eT&&(0,a.jsx)(n.pj,{padding:"checkbox",children:(0,a.jsx)(F.X,{checked:L.students.length>0&&e3===L.students.length||e3>0&&"indeterminate",onCheckedChange:e=>eJ(e),"aria-label":"Seleccionar todo"})}),(0,a.jsx)(n.ss,{children:"#"}),(0,a.jsx)(n.ss,{className:"hidden w-[100px] sm:table-cell",children:(0,a.jsx)("span",{className:"sr-only",children:"Foto"})}),(0,a.jsx)(n.ss,{children:"Nombre"}),(0,a.jsx)(n.ss,{children:"Nivel de Riesgo"}),(0,a.jsx)(n.ss,{children:(0,a.jsx)("span",{className:"sr-only",children:"Acciones"})})]})}),(0,a.jsxs)(n.RM,{children:[L.students.map((e,t)=>{let s=eq[e.id]||{level:"low",reason:""};return(0,a.jsxs)(n.SC,{"data-state":eE.includes(e.id)&&"selected",children:[eT&&(0,a.jsx)(n.pj,{padding:"checkbox",children:(0,a.jsx)(F.X,{checked:eE.includes(e.id),onCheckedChange:()=>eH(e.id),"aria-label":"Seleccionar fila"})}),(0,a.jsx)(n.pj,{className:"text-muted-foreground",children:t+1}),(0,a.jsx)(n.pj,{className:"hidden sm:table-cell",children:(0,a.jsx)(o.default,{alt:"Foto del estudiante",className:"aspect-square rounded-md object-cover",height:"64",src:e.photo,"data-ai-hint":"student photo",width:"64"})}),(0,a.jsx)(n.pj,{className:"font-medium",children:e.name}),(0,a.jsxs)(n.pj,{children:["high"===s.level&&(0,a.jsx)(i.C,{variant:"destructive",children:"Alto"}),"medium"===s.level&&(0,a.jsx)(i.C,{variant:"secondary",className:"bg-amber-400 text-black",children:"Medio"}),"low"===s.level&&(0,a.jsx)(i.C,{variant:"secondary",children:"Bajo"})]}),(0,a.jsx)(n.pj,{children:(0,a.jsxs)(R.h_,{children:[(0,a.jsx)(R.$F,{asChild:!0,children:(0,a.jsxs)(l.z,{"aria-haspopup":"true",size:"icon",variant:"ghost",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Toggle menu"})]})}),(0,a.jsxs)(R.AW,{align:"end",children:[(0,a.jsx)(R.Ju,{children:"Acciones"}),(0,a.jsx)(R.Xi,{onClick:()=>er.push("/students/".concat(e.id)),children:"Ver Perfil Completo"}),(0,a.jsxs)(R.Xi,{onClick:()=>e5(e),children:[(0,a.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),"Editar Informaci\xf3n"]}),(0,a.jsxs)(R.Xi,{onClick:()=>eQ(e),children:[(0,a.jsx)(y.Z,{className:"mr-2 h-4 w-4"}),"Cambiar Foto"]}),(0,a.jsx)(R.VD,{}),(0,a.jsx)(R.Xi,{onClick:()=>eB([e.id]),className:"text-destructive",children:"Quitar del Grupo"})]})]})})]},e.id)}),0===L.students.length&&(0,a.jsx)(n.SC,{children:(0,a.jsx)(n.pj,{colSpan:6,className:"text-center text-muted-foreground p-8",children:"No hay estudiantes en este grupo."})})]})]})})]}),(0,a.jsxs)(r.Zb,{children:[(0,a.jsxs)(r.Ol,{children:[(0,a.jsx)(r.ll,{children:"Acciones del Grupo"}),(0,a.jsx)(r.SZ,{children:"Gestiona la asistencia, criterios de evaluaci\xf3n y calificaciones del grupo."})]}),(0,a.jsxs)(r.aY,{className:"grid gap-4",children:[(0,a.jsx)(l.z,{asChild:!0,variant:"outline",children:(0,a.jsxs)(c.default,{href:"/attendance",children:[(0,a.jsx)(w.Z,{className:"mr-2 h-4 w-4"}),"Tomar Asistencia"]})}),(0,a.jsx)(l.z,{asChild:!0,variant:"outline",children:(0,a.jsxs)(c.default,{href:"/participations",children:[(0,a.jsx)(g.Z,{className:"mr-2 h-4 w-4"}),"Registrar Participaciones"]})}),(0,a.jsx)(l.z,{asChild:!0,variant:"outline",children:(0,a.jsxs)(c.default,{href:"/grades/".concat(L.id,"/criteria"),children:[(0,a.jsx)(g.Z,{className:"mr-2 h-4 w-4"}),"Gestionar Criterios"]})}),(0,a.jsx)(l.z,{asChild:!0,children:(0,a.jsxs)(c.default,{href:"/grades/".concat(L.id,"/grades"),children:[(0,a.jsx)(C.Z,{className:"mr-2 h-4 w-4"}),"Registrar Calificaciones"]})})]}),(0,a.jsxs)(r.Ol,{className:"pt-0",children:[(0,a.jsx)(r.ll,{className:"text-lg",children:"Resumen de Criterios"}),(0,a.jsxs)(r.SZ,{children:["Peso total: ",e1,"%"]})]}),(0,a.jsx)(r.aY,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[ea.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted rounded-md",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Portafolio"===e.name||"Actividades"===e.name||"Participaci\xf3n"===e.name?"C\xe1lculo Autom\xe1tico":"".concat(e.expectedValue," es el valor esperado")})]}),(0,a.jsxs)(i.C,{variant:"secondary",children:[e.weight,"%"]})]},e.id)),0===ea.length&&(0,a.jsx)("p",{className:"text-sm text-center text-muted-foreground py-4",children:"No has definido criterios."}),e1>100&&(0,a.jsxs)("div",{className:"text-center text-sm font-bold text-destructive pt-2",children:["Total: ",e1,"% (Sobrepasa el 100%)"]})]})})]}),(0,a.jsxs)(r.Zb,{className:"lg:col-span-3 border-destructive/50",children:[(0,a.jsxs)(r.Ol,{children:[(0,a.jsxs)(r.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(k.Z,{className:"h-5 w-5 text-destructive"}),"Estudiantes en Riesgo (An\xe1lisis Predictivo)"]}),(0,a.jsx)(r.SZ,{children:"Predicci\xf3n de reprobaci\xf3n y abandono escolar basada en regresi\xf3n de tendencias de asistencia y entrega de actividades."})]}),(0,a.jsx)(r.aY,{children:(0,a.jsxs)(n.iA,{children:[(0,a.jsx)(n.xD,{children:(0,a.jsxs)(n.SC,{children:[(0,a.jsx)(n.ss,{children:"Estudiante"}),(0,a.jsx)(n.ss,{children:"Riesgo Reprobaci\xf3n"}),(0,a.jsx)(n.ss,{children:"Riesgo Abandono"}),(0,a.jsx)(n.ss,{children:"Factores Cr\xedticos"}),(0,a.jsx)(n.ss,{children:"Historial / Origen"}),(0,a.jsx)(n.ss,{children:"Predicci\xf3n / Acci\xf3n"})]})}),(0,a.jsxs)(n.RM,{children:[eX.filter(e=>"low"!==e.riskLevel).map(e=>(0,a.jsxs)(n.SC,{children:[(0,a.jsx)(n.pj,{className:"font-medium",children:e.studentName}),(0,a.jsx)(n.pj,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-2 w-16 bg-secondary rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-destructive",style:{width:"".concat(e.failingRisk,"%")}})}),(0,a.jsxs)("span",{className:"text-xs",children:[e.failingRisk.toFixed(0),"%"]})]})}),(0,a.jsx)(n.pj,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-2 w-16 bg-secondary rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-orange-500",style:{width:"".concat(e.dropoutRisk,"%")}})}),(0,a.jsxs)("span",{className:"text-xs",children:[e.dropoutRisk.toFixed(0),"%"]})]})}),(0,a.jsx)(n.pj,{children:(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:e.riskFactors.map((e,t)=>(0,a.jsx)(i.C,{variant:"outline",className:"text-xs border-destructive text-destructive",children:e},t))})}),(0,a.jsx)(n.pj,{children:(0,a.jsxs)("div",{className:"flex flex-col gap-1 text-xs",children:[e.history&&e.history.map(e=>(0,a.jsxs)("div",{className:(0,P.cn)("flex justify-between gap-2",e.isCurrent&&"font-bold text-primary"),children:[(0,a.jsxs)("span",{children:[e.label,":"]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[e.grade.toFixed(1),e.isRecovery&&(0,a.jsx)("span",{className:"text-destructive font-bold",children:"R"}),"/ ",e.attendance.toFixed(0),"%"]})]},e.id)),(!e.history||0===e.history.length)&&(0,a.jsx)("span",{className:"text-muted-foreground",children:"Sin datos"})]})}),(0,a.jsx)(n.pj,{className:"text-sm text-muted-foreground",children:e.predictionMessage})]},e.studentId)),0===eX.filter(e=>"low"!==e.riskLevel).length&&(0,a.jsx)(n.SC,{children:(0,a.jsx)(n.pj,{colSpan:6,className:"text-center text-muted-foreground py-4",children:"No se detectaron estudiantes en riesgo alto o medio."})})]})]})})]})]})})]})]})]}):(0,a.jsx)("div",{className:"flex justify-center items-center h-full text-center",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"No hay un grupo activo."}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Por favor, crea o selecciona un grupo para continuar."}),(0,a.jsx)(l.z,{asChild:!0,className:"mt-4",children:(0,a.jsx)(c.default,{href:"/groups",children:"Ir a Grupos"})})]})})}},29943:function(e,t,s){"use strict";s.d(t,{OL:function(){return g},_T:function(){return m},aR:function(){return d},f$:function(){return x},fY:function(){return f},le:function(){return j},vW:function(){return o},xo:function(){return h},yT:function(){return p}});var a=s(57437),r=s(2265),n=s(76669),i=s(49354),l=s(89733);let d=n.fC,o=n.xz,c=n.h_,u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.aV,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r,ref:t})});u.displayName=n.aV.displayName;let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(u,{}),(0,a.jsx)(n.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...r})]})});m.displayName=n.VY.displayName;let f=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};f.displayName="AlertDialogHeader";let h=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};h.displayName="AlertDialogFooter";let x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold",s),...r})});x.displayName=n.Dx.displayName;let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});p.displayName=n.dk.displayName;let g=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.aU,{ref:t,className:(0,i.cn)((0,l.d)(),s),...r})});g.displayName=n.aU.displayName;let j=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.$j,{ref:t,className:(0,i.cn)((0,l.d)({variant:"outline"}),"mt-2 sm:mt-0",s),...r})});j.displayName=n.$j.displayName},79055:function(e,t,s){"use strict";s.d(t,{C:function(){return l}});var a=s(57437);s(2265);var r=s(13027),n=s(49354);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(i({variant:s}),t),...r})}},89733:function(e,t,s){"use strict";s.d(t,{d:function(){return d},z:function(){return o}});var a=s(57437),r=s(2265),n=s(71538),i=s(13027),l=s(49354);let d=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,t)=>{let{className:s,variant:r,size:i,asChild:o=!1,...c}=e,u=o?n.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(d({variant:r,size:i,className:s})),ref:t,...c})});o.displayName="Button"},48185:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return i},aY:function(){return c},eW:function(){return u},ll:function(){return d}});var a=s(57437),r=s(2265),n=s(49354);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});i.displayName="Card";let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})});l.displayName="CardHeader";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});d.displayName="CardTitle";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});o.displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...r})});c.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"},44541:function(e,t,s){"use strict";s.d(t,{X:function(){return d}});var a=s(57437),r=s(2265),n=s(69324),i=s(60926),l=s(49354);let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.fC,{ref:t,className:(0,l.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...r,children:(0,a.jsx)(n.z$,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})})});d.displayName=n.fC.displayName},54662:function(e,t,s){"use strict";s.d(t,{$N:function(){return p},Be:function(){return g},GG:function(){return u},Vq:function(){return d},cN:function(){return x},cZ:function(){return f},fK:function(){return h},hg:function(){return o}});var a=s(57437),r=s(2265),n=s(13304),i=s(74732),l=s(49354);let d=n.fC,o=n.xz,c=n.h_,u=n.x8,m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});m.displayName=n.aV.displayName;let f=r.forwardRef((e,t)=>{let{className:s,children:r,...d}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(m,{}),(0,a.jsxs)(n.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...d,children:[r,(0,a.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=n.VY.displayName;let h=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};h.displayName="DialogHeader";let x=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};x.displayName="DialogFooter";let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});p.displayName=n.Dx.displayName;let g=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...r})});g.displayName=n.dk.displayName},31590:function(e,t,s){"use strict";s.d(t,{$F:function(){return u},AW:function(){return m},Ju:function(){return h},VD:function(){return x},Xi:function(){return f},h_:function(){return c}});var a=s(57437),r=s(2265),n=s(81622),i=s(51601),l=s(60926),d=s(52732),o=s(49354);let c=n.fC,u=n.xz;n.ZA,n.Uv,n.Tr,n.Ee,r.forwardRef((e,t)=>{let{className:s,inset:r,children:l,...d}=e;return(0,a.jsxs)(n.fF,{ref:t,className:(0,o.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...d,children:[l,(0,a.jsx)(i.Z,{className:"ml-auto"})]})}).displayName=n.fF.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.tu,{ref:t,className:(0,o.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})}).displayName=n.tu.displayName;let m=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...i}=e;return(0,a.jsx)(n.Uv,{children:(0,a.jsx)(n.VY,{ref:t,sideOffset:r,className:(0,o.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})})});m.displayName=n.VY.displayName;let f=r.forwardRef((e,t)=>{let{className:s,inset:r,...i}=e;return(0,a.jsx)(n.ck,{ref:t,className:(0,o.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...i})});f.displayName=n.ck.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,checked:i,...d}=e;return(0,a.jsxs)(n.oC,{ref:t,className:(0,o.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:i,...d,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.wU,{children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})}),r]})}).displayName=n.oC.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,...i}=e;return(0,a.jsxs)(n.Rk,{ref:t,className:(0,o.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.wU,{children:(0,a.jsx)(d.Z,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=n.Rk.displayName;let h=r.forwardRef((e,t)=>{let{className:s,inset:r,...i}=e;return(0,a.jsx)(n.__,{ref:t,className:(0,o.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...i})});h.displayName=n.__.displayName;let x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.Z0,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...r})});x.displayName=n.Z0.displayName},77209:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var a=s(57437),r=s(2265),n=s(49354);let i=r.forwardRef((e,t)=>{let{className:s,type:r,...i}=e;return(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...i})});i.displayName="Input"},70402:function(e,t,s){"use strict";s.d(t,{_:function(){return o}});var a=s(57437),r=s(2265),n=s(38364),i=s(13027),l=s(49354);let d=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.f,{ref:t,className:(0,l.cn)(d(),s),...r})});o.displayName=n.f.displayName},47304:function(e,t,s){"use strict";s.d(t,{RM:function(){return d},SC:function(){return o},iA:function(){return i},pj:function(){return u},ss:function(){return c},xD:function(){return l}});var a=s(57437),r=s(2265),n=s(49354);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",s),...r})})});i.displayName="Table";let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",s),...r})});l.displayName="TableHeader";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",s),...r})});d.displayName="TableBody",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})}).displayName="TableFooter";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r})});o.displayName="TableRow";let c=r.forwardRef((e,t)=>{let{className:s,padding:r="default",...i}=e;return(0,a.jsx)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground","checkbox"===r?"p-2 w-4":"",s),...i})});c.displayName="TableHead";let u=r.forwardRef((e,t)=>{let{className:s,padding:r="default",...i}=e;return(0,a.jsx)("td",{ref:t,className:(0,n.cn)("p-4 align-middle","checkbox"===r?"p-2":"",s),...i})});u.displayName="TableCell",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",s),...r})}).displayName="TableCaption"},86864:function(e,t,s){"use strict";s.d(t,{SP:function(){return o},dr:function(){return d},mQ:function(){return l},nU:function(){return c}});var a=s(57437),r=s(2265),n=s(62447),i=s(49354);let l=n.fC,d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.aV,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});d.displayName=n.aV.displayName;let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.xz,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});o.displayName=n.xz.displayName;let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.VY,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});c.displayName=n.VY.displayName},4919:function(e,t,s){"use strict";s.d(t,{g:function(){return i}});var a=s(57437),r=s(2265),n=s(49354);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});i.displayName="Textarea"},86763:function(e,t,s){"use strict";s.d(t,{pm:function(){return m}});var a=s(2265);let r=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],o={toasts:[]};function c(e){o=l(o,e),d.forEach(e=>{e(o)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,t]=a.useState(o);return a.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},15026:function(e,t,s){"use strict";s.d(t,{l:function(){return i}});let a=["aislado","aislamiento","irritable","irritabilidad","conflictivo","agresivo","distra\xeddo","instrucciones","duerme","sue\xf1o","desmotivado","triste","ansiedad","llanto"],r=e=>1/(1+Math.exp(-e)),n=(e,t,s,r,n)=>{let i=[];return(t>60||r<85)&&i.push("RIESGO_ASISTENCIA"),e>60&&i.push("RIESGO_ACADEMICO"),s<.6&&i.push("RIESGO_EJECUTIVO"),n.some(e=>a.some(t=>e.toLowerCase().includes(t)))&&i.push("RIESGO_CONDUCTUAL"),i},i=function(e,t,s,a){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],l=arguments.length>5?arguments[5]:void 0,d=new Date,o=Object.keys(t.attendance||{}).sort(),c=o.filter(s=>t.attendance[s][e.id]).length,u=o.length,m=u>0?c/u*100:100,f=0;if(o.length>=3){let s=o.length,a=o.slice(-10),r=Array.from({length:a.length},(e,t)=>t),n=a.map(s=>t.attendance[s][e.id]?1:0),i=r.reduce((e,t)=>e+t,0),l=n.reduce((e,t)=>e+t,0),d=r.reduce((e,t,s)=>e+t*n[s],0),c=s*r.reduce((e,t)=>e+t*t,0)-i*i;0!==c&&(f=(s*d-i*l)/c)}let h=m;f<0&&(h+=20*f),h=Math.max(0,Math.min(100,h));let x=0,p=0,g=0,j=0;s.forEach(s=>{if("Actividades"===s.name||"Portafolio"===s.name){let a=(t.activities||[]).filter(s=>{var a,r,n,i;if(!s.dueDate)return null===(r=t.activityRecords)||void 0===r?void 0:null===(a=r[e.id])||void 0===a?void 0:a[s.id];let l=new Date(s.dueDate)<=d,o=null===(i=t.activityRecords)||void 0===i?void 0:null===(n=i[e.id])||void 0===n?void 0:n[s.id];return l||o}),r=a.length;if(g+=r,r>0){let n=a.filter(s=>{var a,r;return null===(r=t.activityRecords)||void 0===r?void 0:null===(a=r[e.id])||void 0===a?void 0:a[s.id]}).length;j+=n,x+=n/r*s.weight,p+=s.weight}}else if("Participaci\xf3n"===s.name){let a=Object.keys(t.participations||{}).length;if(a>0){let r=Object.values(t.participations).filter(t=>t[e.id]).length;x+=r/a*s.weight,p+=s.weight}}else{var a,r;let n=null===(r=t.grades)||void 0===r?void 0:null===(a=r[e.id])||void 0===a?void 0:a[s.id];if(n&&null!==n.delivered&&void 0!==n.delivered){let e=n.delivered/s.expectedValue;x+=e*s.weight,p+=s.weight}}});let v=p>0?x/p*100:100,N=!1;if(void 0!==l)v=l;else{var b;let s=null===(b=t.recoveryGrades)||void 0===b?void 0:b[e.id];s&&s.applied&&null!==s.grade&&(v=s.grade,N=!0)}let y=g-j,w=g>0?j/g:1,C=Math.min(1,p/20),k=4+-.08*v+-3.5*w,R=0;R=p>0?100*r(k*C):0,v<60&&p>20&&(R=Math.max(R,85));let S=Object.keys(t.participations||{}).length,E=Object.values(t.participations||{}).filter(t=>t[e.id]).length,z=(S>0?E/S:1)<.3,T=100*r(-2+-.05*(m-70)+-10*f);0===o.length&&(T=0),z&&S>0&&(T+=15),T>100&&(T=99);let A="low";T>60||R>70?A="high":(T>30||R>40)&&(A="medium");let _=[];m<85&&_.push("Inasistencias cr\xedticas (".concat((100-m).toFixed(0),"%)")),w<.6&&_.push("Baja entrega de actividades (".concat((100*w).toFixed(0),"%)")),f<-.05&&_.push("Tendencia de asistencia negativa"),v<60&&p>10&&_.push("Promedio actual reprobatorio (".concat(v.toFixed(1),")")),z&&_.push("Desconexi\xf3n en clase (Baja participaci\xf3n)");let F="Rendimiento dentro de par\xe1metros esperados.";"high"===A?F=T>R?"ALERTA DE DESERCI\xd3N (".concat(T.toFixed(0),"%): El patr\xf3n de inasistencias sugiere riesgo inminente de abandono."):"RIESGO ACAD\xc9MICO CR\xcdTICO (".concat(R.toFixed(0),"%): Proyecci\xf3n de reprobaci\xf3n alta si no mejora entrega de actividades."):"medium"===A&&(F="Se detectan se\xf1ales tempranas de riesgo. Se recomienda intervenci\xf3n preventiva.");let O=n(R,T,w,m,i);return{studentId:e.id,studentName:e.name,currentGrade:v,projectedGrade:v,currentAttendance:m,projectedAttendance:h,missedActivitiesCount:y,lowParticipation:z,failingRisk:R,dropoutRisk:T,riskLevel:A,riskFactors:_,predictionMessage:F,pigecFlags:O,isRecovery:N}}}},function(e){e.O(0,[4358,139,6900,537,6452,7138,1119,3928,3956,381,4387,6669,5524,4405,3730,2971,7023,1744],function(){return e(e.s=62735)}),_N_E=e.O()}]);