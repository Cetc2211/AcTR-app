(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4992],{33667:function(e,r,t){Promise.resolve().then(t.bind(t,27184))},27184:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return j}});var a=t(57437),s=t(48185),n=t(47304),l=t(67568),i=t(2265),d=t(66648),c=t(87138),o=t(38087),u=t(64443),f=t(79055),m=t(49354),x=t(9646);let p=i.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(x.fC,{className:(0,m.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...s,ref:r,children:(0,a.jsx)(x.bU,{className:(0,m.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});p.displayName=x.fC.displayName;var h=t(70402);function j(){let{activeGroup:e,calculateDetailedFinalGrade:r,isLoading:t,fetchPartialData:x,updateGroup:j}=(0,l.e)(),[g,b]=(0,i.useState)([]),[N,v]=(0,i.useState)(!0),[y,w]=(0,i.useState)([]),R=async r=>{e&&await j(e.id,{isSemesterIntegrated:r})};if((0,i.useEffect)(()=>{let a=async()=>{if(!e){v(!1);return}v(!0);let t=["p1","p2","p3"],a=[],s=await Promise.all(t.map(r=>x(e.id,r)));s.forEach((e,r)=>{e&&(Object.keys(e.grades).length>0||Object.keys(e.recoveryGrades||{}).length>0||Object.keys(e.attendance||{}).length>0)&&a.push(t[r])}),w(a);let n=e.students.map(async a=>{let n={},l=0,i=0;t.forEach((t,d)=>{let c=s[d],o=e.criteria||[];if(c&&(o.length>0||Object.keys(c.recoveryGrades||{}).length>0)){let{finalGrade:e,isRecovery:s}=r(a.id,c,o),d=!1;if(e>0)d=!0;else{let e=c.attendance&&Object.values(c.attendance).some(e=>void 0!==e[a.id]),r=c.activityRecords&&c.activityRecords[a.id]&&Object.keys(c.activityRecords[a.id]).length>0,t=c.grades&&c.grades[a.id]&&Object.keys(c.grades[a.id]).length>0,s=c.recoveryGrades&&c.recoveryGrades[a.id];(e||r||t||s)&&(d=!0)}d&&(n[t]={grade:e,isRecovery:s},l+=e,i++)}});let d=i>0?l/i:void 0;return{student:a,p1:n.p1,p2:n.p2,p3:n.p3,average:d}});b((await Promise.all(n)).sort((e,r)=>e.student.name.localeCompare(r.student.name))),v(!1)};t||a()},[e,r,x,t]),t)return(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsx)(o.Z,{className:"h-8 w-8 animate-spin"})});if(N)return(0,a.jsxs)("div",{className:"flex items-center justify-center h-full",children:[(0,a.jsx)(o.Z,{className:"h-8 w-8 animate-spin"})," ",(0,a.jsx)("span",{className:"ml-2",children:"Calculando calificaciones semestrales..."})]});if(!e)return(0,a.jsx)(s.Zb,{children:(0,a.jsxs)(s.Ol,{className:"text-center",children:[(0,a.jsx)(u.Z,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,a.jsx)(s.ll,{children:"Evaluaci\xf3n Semestral"}),(0,a.jsxs)(s.SZ,{children:["Para ver esta secci\xf3n, por favor ",(0,a.jsx)(c.default,{href:"/groups",className:"text-primary underline",children:"selecciona un grupo"})," primero."]})]})});if(!e.criteria||0===e.criteria.length)return(0,a.jsx)(s.Zb,{children:(0,a.jsxs)(s.Ol,{className:"text-center",children:[(0,a.jsx)(u.Z,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,a.jsx)(s.ll,{children:"Faltan Criterios de Evaluaci\xf3n"}),(0,a.jsxs)(s.SZ,{children:["Para calcular la evaluaci\xf3n semestral, primero debes ",(0,a.jsx)(c.default,{href:"/grades/".concat(e.id,"/criteria"),className:"text-primary underline",children:"definir los criterios de evaluaci\xf3n"}),' para el grupo "',e.subject,'".']})]})});let C=e=>{let{data:r}=e;return void 0===r?(0,a.jsx)("span",{className:"text-muted-foreground",children:"N/A"}):(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsxs)("span",{children:[r.grade.toFixed(1),"%"]}),r.isRecovery&&(0,a.jsx)("span",{className:"text-red-500 font-bold",children:"R"})]})};return(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Evaluaci\xf3n Semestral"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:["Resumen de calificaciones de los parciales y promedio final para el grupo: ",e.subject]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 bg-card p-4 rounded-lg border shadow-sm",children:[(0,a.jsx)(p,{id:"integrate-semester",checked:e.isSemesterIntegrated||!1,onCheckedChange:R}),(0,a.jsx)(h._,{htmlFor:"integrate-semester",className:"cursor-pointer",children:"Integrar Promedio Semestral al Riesgo"})]})]}),(0,a.jsx)(s.Zb,{children:(0,a.jsx)(s.aY,{className:"p-0",children:(0,a.jsxs)(n.iA,{children:[(0,a.jsx)(n.xD,{children:(0,a.jsxs)(n.SC,{children:[(0,a.jsx)(n.ss,{className:"w-[300px]",children:"Estudiante"}),y.includes("p1")&&(0,a.jsx)(n.ss,{className:"text-center bg-partial-1-bg text-partial-1-foreground-alt",children:"Primer Parcial"}),y.includes("p2")&&(0,a.jsx)(n.ss,{className:"text-center bg-partial-2-bg text-partial-2-foreground-alt",children:"Segundo Parcial"}),y.includes("p3")&&(0,a.jsx)(n.ss,{className:"text-center bg-partial-3-bg text-partial-3-foreground-alt",children:"Tercer Parcial"}),(0,a.jsx)(n.ss,{className:"text-center font-bold",children:"Promedio Semestral"})]})}),(0,a.jsxs)(n.RM,{children:[g.map(e=>{let{student:r,p1:t,p2:s,p3:l,average:i}=e;return(0,a.jsxs)(n.SC,{children:[(0,a.jsxs)(n.pj,{className:"font-medium flex items-center gap-3",children:[(0,a.jsx)(d.default,{src:r.photo,alt:r.name,width:40,height:40,className:"rounded-full"}),r.name]}),y.includes("p1")&&(0,a.jsx)(n.pj,{className:"text-center font-semibold",children:(0,a.jsx)(C,{data:t})}),y.includes("p2")&&(0,a.jsx)(n.pj,{className:"text-center font-semibold",children:(0,a.jsx)(C,{data:s})}),y.includes("p3")&&(0,a.jsx)(n.pj,{className:"text-center font-semibold",children:(0,a.jsx)(C,{data:l})}),(0,a.jsx)(n.pj,{className:"text-center",children:void 0!==i?(0,a.jsxs)(f.C,{className:(0,m.cn)("text-base",i>=60?"bg-primary":"bg-destructive"),children:[i.toFixed(1),"%"]}):(0,a.jsx)(f.C,{variant:"outline",children:"Pendiente"})})]},r.id)}),0===e.students.length&&(0,a.jsx)(n.SC,{children:(0,a.jsx)(n.pj,{colSpan:5,className:"text-center h-24",children:"Este grupo no tiene estudiantes."})})]})]})})})]})}},79055:function(e,r,t){"use strict";t.d(r,{C:function(){return i}});var a=t(57437);t(2265);var s=t(13027),n=t(49354);let l=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:r,variant:t,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:t}),r),...s})}},48185:function(e,r,t){"use strict";t.d(r,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return l},aY:function(){return o},eW:function(){return u},ll:function(){return d}});var a=t(57437),s=t(2265),n=t(49354);let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});l.displayName="Card";let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...s})});i.displayName="CardHeader";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});d.displayName="CardTitle";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...s})});c.displayName="CardDescription";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...s})});o.displayName="CardContent";let u=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...s})});u.displayName="CardFooter"},70402:function(e,r,t){"use strict";t.d(r,{_:function(){return c}});var a=t(57437),s=t(2265),n=t(38364),l=t(13027),i=t(49354);let d=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(n.f,{ref:r,className:(0,i.cn)(d(),t),...s})});c.displayName=n.f.displayName},47304:function(e,r,t){"use strict";t.d(r,{RM:function(){return d},SC:function(){return c},iA:function(){return l},pj:function(){return u},ss:function(){return o},xD:function(){return i}});var a=t(57437),s=t(2265),n=t(49354);let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:r,className:(0,n.cn)("w-full caption-bottom text-sm",t),...s})})});l.displayName="Table";let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("thead",{ref:r,className:(0,n.cn)("[&_tr]:border-b",t),...s})});i.displayName="TableHeader";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tbody",{ref:r,className:(0,n.cn)("[&_tr:last-child]:border-0",t),...s})});d.displayName="TableBody",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tfoot",{ref:r,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...s})}).displayName="TableFooter";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tr",{ref:r,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s})});c.displayName="TableRow";let o=s.forwardRef((e,r)=>{let{className:t,padding:s="default",...l}=e;return(0,a.jsx)("th",{ref:r,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground","checkbox"===s?"p-2 w-4":"",t),...l})});o.displayName="TableHead";let u=s.forwardRef((e,r)=>{let{className:t,padding:s="default",...l}=e;return(0,a.jsx)("td",{ref:r,className:(0,n.cn)("p-4 align-middle","checkbox"===s?"p-2":"",t),...l})});u.displayName="TableCell",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("caption",{ref:r,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",t),...s})}).displayName="TableCaption"}},function(e){e.O(0,[4358,139,6900,537,6452,7138,3928,1715,3730,2971,7023,1744],function(){return e(e.s=33667)}),_N_E=e.O()}]);