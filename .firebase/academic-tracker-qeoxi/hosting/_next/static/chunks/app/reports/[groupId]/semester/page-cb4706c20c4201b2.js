(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5061],{64311:function(e,t,s){Promise.resolve().then(s.bind(s,59143))},16463:function(e,t,s){"use strict";var n=s(71169);s.o(n,"notFound")&&s.d(t,{notFound:function(){return n.notFound}}),s.o(n,"useParams")&&s.d(t,{useParams:function(){return n.useParams}}),s.o(n,"usePathname")&&s.d(t,{usePathname:function(){return n.usePathname}}),s.o(n,"useRouter")&&s.d(t,{useRouter:function(){return n.useRouter}})},59143:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return C}});var n=s(57437),r=s(2265),a=s(48185),l=s(89733),i=s(16463),o=s(66648),d=s(87138),c=s(38087),u=s(86644),f=s(16508),m=s(62037),p=s(44182),x=s(6497);let h=(0,x.Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),g=(0,x.Z)("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);var y=s(6460),j=s(81608),b=s(86763),v=s(97501),N=s(81173),w=s.n(N),S=s(67568),A=s(4919);function C(){let e=(0,i.useParams)().groupId,{groups:t,settings:s,calculateDetailedFinalGrade:x,atRiskStudents:N,allObservations:C,isLoading:k,fetchPartialData:O}=(0,S.e)(),[R,_]=(0,r.useState)(null),[E,T]=(0,r.useState)(!1),I=(0,r.useRef)(null),{toast:Z}=(0,b.pm)(),[P,F]=(0,r.useState)(""),[D,z]=(0,r.useState)(!1);(0,r.useEffect)(()=>{T(!0)},[]);let M=(0,r.useMemo)(()=>t.find(t=>t.id===e),[t,e]);return((0,r.useEffect)(()=>{M&&!k&&(async()=>{let e=M.students.length;if(0===e){_({totalStudents:0,approvedCount:0,failedCount:0,groupAverage:0,attendanceRate:100});return}let t=await Promise.all(["p1","p2","p3"].map(e=>O(M.id,e))),s=0,n=0,r=0,a=0;for(let e of M.students){let l=0,i=0;for(let s of t)if(s){let{finalGrade:t}=x(e.id,s,M.criteria);l+=t,i++,Object.values(s.attendance).forEach(t=>{Object.prototype.hasOwnProperty.call(t,e.id)&&(n++,t[e.id]&&r++)})}let o=i>0?l/i:0;s+=o,o>=60&&a++}_({totalStudents:e,approvedCount:a,failedCount:e-a,groupAverage:e>0?s/e:0,attendanceRate:n>0?r/n*100:100})})()},[M,x,k,O]),k||!R)?(0,n.jsxs)("div",{className:"flex items-center justify-center h-full",children:[(0,n.jsx)(c.Z,{className:"h-8 w-8 animate-spin"})," ",(0,n.jsx)("span",{className:"ml-2",children:"Generando informe semestral..."})]}):M?(0,n.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(l.z,{asChild:!0,variant:"outline",size:"icon",children:(0,n.jsxs)(d.default,{href:"/reports",children:[(0,n.jsx)(u.Z,{}),(0,n.jsx)("span",{className:"sr-only",children:"Volver a Informes"})]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"Informe General Semestral"}),(0,n.jsxs)("p",{className:"text-muted-foreground",children:['Resumen de todo el semestre para "',M.subject,'"']})]})]}),(0,n.jsx)("div",{className:"flex items-center gap-2 flex-wrap","data-hide-for-pdf":"true",children:(0,n.jsxs)(l.z,{onClick:()=>{let e=I.current;if(e){Z({title:"Generando PDF...",description:"Esto puede tardar un momento."});let s=e.querySelectorAll('[data-hide-for-pdf="true"]');s.forEach(e=>e.style.display="none");let n=e.querySelector("textarea"),r=document.createElement("div");if(n){var t;r.innerHTML=n.value.replace(/\\n/g,"<br>"),r.className=n.className,r.style.whiteSpace="pre-wrap",r.style.minHeight=n.style.minHeight||"100px",r.style.fontFamily="inherit",r.style.fontSize="inherit",r.style.lineHeight="inherit",r.style.color="inherit",n.style.display="none",null===(t=n.parentNode)||void 0===t||t.insertBefore(r,n)}w()(e,{scale:2,useCORS:!0}).then(e=>{let t=e.toDataURL("image/png"),s=new v.ZP("p","mm","a4"),n=s.internal.pageSize.getWidth(),r=s.internal.pageSize.getHeight(),a=e.width/e.height,l=n-20,i=l/a;i>r-20&&(l=(i=r-20)*a),s.addImage(t,"PNG",10,10,l,i),s.save("informe_semestral_".concat((null==M?void 0:M.subject.replace(/\s+/g,"_"))||"reporte",".pdf"))}).finally(()=>{s.forEach(e=>e.style.display=""),n&&(n.style.display="block",r.remove())})}},children:[(0,n.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Descargar Informe"]})})]}),(0,n.jsxs)(a.Zb,{ref:I,id:"report-content",className:"p-4 sm:p-6 md:p-8",children:[(0,n.jsxs)("header",{className:"border-b pb-6 mb-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:s.institutionName}),(0,n.jsx)("p",{className:"text-lg text-muted-foreground",children:"Informe de Rendimiento Acad\xe9mico Semestral"})]}),E&&s.logo?(0,n.jsx)("img",{src:s.logo,alt:"Logo de la Instituci\xf3n",style:{width:"80px",height:"80px",objectFit:"contain"}}):(0,n.jsx)("div",{className:"w-[80px] h-[80px]"})]}),(0,n.jsxs)("div",{className:"pt-4 flex justify-between text-sm text-muted-foreground",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-semibold text-foreground",children:"Asignatura: "}),(0,n.jsx)("span",{children:M.subject})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-semibold text-foreground",children:"Fecha del Informe: "}),(0,n.jsx)("span",{children:(0,y.WU)(new Date,"PPP",{locale:j.es})})]})]})]}),(0,n.jsxs)("section",{className:"space-y-6",children:[(0,n.jsxs)("p",{className:"prose dark:prose-invert max-w-none text-justify",children:["Durante este semestre se atendieron ",(0,n.jsx)("strong",{children:R.totalStudents})," estudiantes, con los siguientes resultados e indicadores clave consolidados:"]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 my-6",children:[(0,n.jsxs)(a.Zb,{className:"text-center",children:[(0,n.jsx)(a.Ol,{children:(0,n.jsx)(a.ll,{className:"text-base",children:"Aprobaci\xf3n Final"})}),(0,n.jsxs)(a.aY,{children:[(0,n.jsxs)("p",{className:"text-3xl font-bold",children:[R.approvedCount," ",(0,n.jsxs)("span",{className:"text-base font-normal text-muted-foreground",children:["de ",R.totalStudents]})]}),(0,n.jsxs)("p",{className:"text-sm text-green-600 flex items-center justify-center gap-1",children:[(0,n.jsx)(m.Z,{className:"h-4 w-4"})," Aprobados"]}),(0,n.jsxs)("p",{className:"text-sm text-red-600 flex items-center justify-center gap-1",children:[(0,n.jsx)(p.Z,{className:"h-4 w-4"})," Reprobados: ",R.failedCount]})]})]}),(0,n.jsxs)(a.Zb,{className:"text-center",children:[(0,n.jsx)(a.Ol,{children:(0,n.jsx)(a.ll,{className:"text-base",children:"Promedio General Semestral"})}),(0,n.jsxs)(a.aY,{children:[(0,n.jsxs)("p",{className:"text-3xl font-bold",children:[R.groupAverage.toFixed(1)," ",(0,n.jsx)("span",{className:"text-base font-normal text-muted-foreground",children:"/ 100"})]}),(0,n.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center justify-center gap-1",children:[(0,n.jsx)(h,{className:"h-4 w-4"})," Calificaci\xf3n media del grupo"]})]})]}),(0,n.jsxs)(a.Zb,{className:"text-center",children:[(0,n.jsx)(a.Ol,{children:(0,n.jsx)(a.ll,{className:"text-base",children:"Asistencia General"})}),(0,n.jsxs)(a.aY,{children:[(0,n.jsxs)("p",{className:"text-3xl font-bold",children:[R.attendanceRate.toFixed(1),"%"]}),(0,n.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center justify-center gap-1",children:[(0,n.jsx)(g,{className:"h-4 w-4"})," Tasa de Asistencia General"]})]})]})]}),(0,n.jsxs)(a.Zb,{children:[(0,n.jsx)(a.Ol,{children:(0,n.jsx)(a.ll,{children:"An\xe1lisis y Observaciones Semestrales"})}),(0,n.jsxs)(a.aY,{className:"space-y-4",children:[(0,n.jsx)("div",{className:"flex justify-between items-center mb-2","data-hide-for-pdf":"true",children:(0,n.jsx)("h4",{className:"font-semibold text-base",children:"An\xe1lisis Narrativo"})}),(0,n.jsx)(A.g,{placeholder:"An\xe1lisis cualitativo del rendimiento del grupo durante el semestre...",value:P,onChange:e=>F(e.target.value),rows:8,className:"w-full text-base text-justify"})]})]})]}),(0,n.jsxs)("footer",{className:"border-t mt-8 pt-6 text-sm",children:[(0,n.jsx)("p",{className:"prose dark:prose-invert max-w-none text-justify",children:"Sin m\xe1s por el momento, quedo a sus \xf3rdenes para cualquier aclaraci\xf3n."}),(0,n.jsxs)("div",{className:"mt-16 pt-4 text-center",children:[(0,n.jsx)("div",{className:"inline-block relative h-20 w-64",children:s.signature&&(0,n.jsx)(o.default,{src:s.signature,alt:"Firma del docente",fill:!0,style:{objectFit:"contain"}})}),(0,n.jsx)("div",{className:"border-t border-foreground w-64 mx-auto mt-2"}),(0,n.jsx)("p",{className:"font-semibold mt-2",children:M.facilitator||"Docente"})]})]})]})]}):(0,i.notFound)()}},89733:function(e,t,s){"use strict";s.d(t,{d:function(){return o},z:function(){return d}});var n=s(57437),r=s(2265),a=s(71538),l=s(13027),i=s(49354);let o=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:s,variant:r,size:l,asChild:d=!1,...c}=e,u=d?a.g7:"button";return(0,n.jsx)(u,{className:(0,i.cn)(o({variant:r,size:l,className:s})),ref:t,...c})});d.displayName="Button"},48185:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return l},aY:function(){return c},eW:function(){return u},ll:function(){return o}});var n=s(57437),r=s(2265),a=s(49354);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});l.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",s),...r})});i.displayName="CardHeader";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});o.displayName="CardTitle";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",s),...r})});d.displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",s),...r})});c.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"},4919:function(e,t,s){"use strict";s.d(t,{g:function(){return l}});var n=s(57437),r=s(2265),a=s(49354);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("textarea",{className:(0,a.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});l.displayName="Textarea"},86763:function(e,t,s){"use strict";s.d(t,{pm:function(){return f}});var n=s(2265);let r=0,a=new Map,l=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?l(s):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=i(d,e),o.forEach(e=>{e(d)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||n()}}}),{id:s,dismiss:n,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function f(){let[e,t]=n.useState(d);return n.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},1584:function(e,t,s){"use strict";s.d(t,{F:function(){return a},e:function(){return l}});var n=s(2265);function r(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function a(...e){return t=>{let s=!1,n=e.map(e=>{let n=r(e,t);return s||"function"!=typeof n||(s=!0),n});if(s)return()=>{for(let t=0;t<n.length;t++){let s=n[t];"function"==typeof s?s():r(e[t],null)}}}}function l(...e){return n.useCallback(a(...e),e)}},71538:function(e,t,s){"use strict";s.d(t,{Z8:function(){return l},g7:function(){return i},sA:function(){return d}});var n=s(2265),r=s(1584),a=s(57437);function l(e){let t=function(e){let t=n.forwardRef((e,t)=>{let{children:s,...a}=e;if(n.isValidElement(s)){let e,l;let i=(e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?s.props.ref:s.props.ref||s.ref,o=function(e,t){let s={...t};for(let n in t){let r=e[n],a=t[n];/^on[A-Z]/.test(n)?r&&a?s[n]=(...e)=>{let t=a(...e);return r(...e),t}:r&&(s[n]=r):"style"===n?s[n]={...r,...a}:"className"===n&&(s[n]=[r,a].filter(Boolean).join(" "))}return{...e,...s}}(a,s.props);return s.type!==n.Fragment&&(o.ref=t?(0,r.F)(t,i):i),n.cloneElement(s,o)}return n.Children.count(s)>1?n.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),s=n.forwardRef((e,s)=>{let{children:r,...l}=e,i=n.Children.toArray(r),o=i.find(c);if(o){let e=o.props.children,r=i.map(t=>t!==o?t:n.Children.count(e)>1?n.Children.only(null):n.isValidElement(e)?e.props.children:null);return(0,a.jsx)(t,{...l,ref:s,children:n.isValidElement(e)?n.cloneElement(e,void 0,r):null})}return(0,a.jsx)(t,{...l,ref:s,children:r})});return s.displayName=`${e}.Slot`,s}var i=l("Slot"),o=Symbol("radix.slottable");function d(e){let t=({children:e})=>(0,a.jsx)(a.Fragment,{children:e});return t.displayName=`${e}.Slottable`,t.__radixId=o,t}function c(e){return n.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}},86644:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(6497).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},62037:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(6497).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},44182:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(6497).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}},function(e){e.O(0,[4358,139,7337,2505,6900,537,6452,7138,3928,8477,3945,3730,2971,7023,1744],function(){return e(e.s=64311)}),_N_E=e.O()}]);